dist: trusty

sudo: required

notifications:
  email: false

language: python

python:
  - "2.7"
  - "3.4"
  - "3.5"
  - "3.6"

env:
 global:
  - SWIG=swig3.0
 matrix:
  # NOTE: pysam 0.9 has a bug with Python 3 and requires Cython
  - CC=gcc-5 PYSAM_VERSION='pysam==0.9.0' PYPI="-i https://testpypi.python.org/pypi" CYTHON_INSTALL='Cython'
  - CC=gcc PYSAM_VERSION='pysam==0.9.0' PYPI="-i https://testpypi.python.org/pypi" CYTHON_INSTALL='Cython'
  - CC=gcc-5 PYSAM_VERSION='pysam==0.9.0' PYPI="" CYTHON_INSTALL='Cython'
  - CC=gcc PYSAM_VERSION='pysam==0.9.0' PYPI="" CYTHON_INSTALL='Cython'
  - CC=gcc-5 PYSAM_VERSION='pysam' PYPI="-i https://testpypi.python.org/pypi"
  - CC=gcc PYSAM_VERSION='pysam' PYPI="-i https://testpypi.python.org/pypi"
  - CC=gcc-5 PYSAM_VERSION='pysam' PYPI=""
  - CC=gcc PYSAM_VERSION='pysam' PYPI=""

addons:
  apt:
    sources:
     - ubuntu-toolchain-r-test
    packages:
     - gcc-5
     - g++-5

before_install:
  - sudo add-apt-repository ppa:nschloe/swig-backports -y
  - sudo apt-get -qq update
  - sudo apt-get install -y swig3.0

install:
  # NOTE: pysam 0.9 has a bug with Python 3 and requires Cython
  - pip install $CYTHON_INSTALL
  - sed -i "s/pysam>=0.9.0/$PYSAM_VERSION/" requirements.txt
  - pip install -r requirements.txt
  - pip install $PYPI HTSeq
 
script:
  - python .travis_test.py
